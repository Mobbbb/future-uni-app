"use strict";const e=require("../common/vendor.js"),t=require("../store/index.js");exports.HttpRequest=class{constructor(e=""){this.baseUrl=e}getInsideConfig(){return{baseURL:this.baseUrl,withCredentials:!0,header:{cookie:this.getCookies()}}}getCookies(){return e.index.getStorageSync("future-token")||""}request(s){return s=Object.assign(this.getInsideConfig(),s),new Promise((o=>{e.index.request({method:s.method||"GET",url:s.baseURL+s.url||"",data:s.data||{},header:s.header||{},responseType:s.responseType||"text",success:s=>{const r=s.data||{},i=s.cookies||[],{data:n,success:a,msg:c,code:d}=r;403===d?(e.index.showToast({title:"登录已失效，请重新登录",duration:2e3,icon:"error"}),t.store.dispatch("app/logoutAction")):!1===a&&e.index.showToast({title:c,duration:2e3,icon:"error"}),r.cookies=i,o(r)},fail:e=>{console.log(e)}})}))}};
